{"ast":null,"code":"import _regeneratorRuntime from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import{PaymentElement,useStripe,useElements}from\"@stripe/react-stripe-js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CheckoutForm(){var stripe=useStripe();var elements=useElements();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];useEffect(function(){if(!stripe){return;}var clientSecret=new URLSearchParams(window.location.search).get(\"payment_intent_client_secret\");if(!clientSecret){return;}stripe.retrievePaymentIntent(clientSecret).then(function(_ref){var paymentIntent=_ref.paymentIntent;switch(paymentIntent.status){case\"succeeded\":setMessage(\"Payment succeeded!\");break;case\"processing\":setMessage(\"Your payment is processing.\");break;case\"requires_payment_method\":setMessage(\"Your payment was not successful, please try again.\");break;default:setMessage(\"Something went wrong.\");break;}});},[stripe]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _yield$stripe$confirm,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();if(!(!stripe||!elements)){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setIsLoading(true);_context.next=6;return stripe.confirmPayment({elements:elements,confirmParams:{// Make sure to change this to your payment completion page\nreturn_url:\"http://localhost:3000\"}});case 6:_yield$stripe$confirm=_context.sent;error=_yield$stripe$confirm.error;// This point will only be reached if there is an immediate error when\n// confirming the payment. Otherwise, your customer will be redirected to\n// your `return_url`. For some payment methods like iDEAL, your customer will\n// be redirected to an intermediate site first to authorize the payment, then\n// redirected to the `return_url`.\nif(error.type===\"card_error\"||error.type===\"validation_error\"){setMessage(error.message);}else{setMessage(\"An unexpected error occurred.\");}setIsLoading(false);case 10:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"form\",{id:\"payment-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(PaymentElement,{id:\"payment-element\"}),/*#__PURE__*/_jsx(\"button\",{disabled:isLoading||!stripe||!elements,id:\"submit\",children:/*#__PURE__*/_jsx(\"span\",{id:\"button-text\",children:isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",id:\"spinner\"}):\"Pay now\"})}),message&&/*#__PURE__*/_jsx(\"div\",{id:\"payment-message\",children:message})]});}","map":{"version":3,"names":["React","useEffect","useState","PaymentElement","useStripe","useElements","CheckoutForm","stripe","elements","message","setMessage","isLoading","setIsLoading","clientSecret","URLSearchParams","window","location","search","get","retrievePaymentIntent","then","paymentIntent","status","handleSubmit","e","preventDefault","confirmPayment","confirmParams","return_url","error","type"],"sources":["C:/webdev/school/school-online-project/client/src/components/student/billing/CheckoutForm.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  PaymentElement,\r\n  useStripe,\r\n  useElements,\r\n} from \"@stripe/react-stripe-js\";\r\n\r\nexport default function CheckoutForm() {\r\n  const stripe = useStripe();\r\n  const elements = useElements();\r\n\r\n  const [message, setMessage] = useState(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!stripe) {\r\n      return;\r\n    }\r\n\r\n    const clientSecret = new URLSearchParams(window.location.search).get(\r\n      \"payment_intent_client_secret\"\r\n    );\r\n\r\n    if (!clientSecret) {\r\n      return;\r\n    }\r\n\r\n    stripe.retrievePaymentIntent(clientSecret).then(({ paymentIntent }) => {\r\n      switch (paymentIntent.status) {\r\n        case \"succeeded\":\r\n          setMessage(\"Payment succeeded!\");\r\n          break;\r\n        case \"processing\":\r\n          setMessage(\"Your payment is processing.\");\r\n          break;\r\n        case \"requires_payment_method\":\r\n          setMessage(\"Your payment was not successful, please try again.\");\r\n          break;\r\n        default:\r\n          setMessage(\"Something went wrong.\");\r\n          break;\r\n      }\r\n    });\r\n  }, [stripe]);\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    if (!stripe || !elements) {\r\n      // Stripe.js has not yet loaded.\r\n      // Make sure to disable form submission until Stripe.js has loaded.\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n\r\n    const { error } = await stripe.confirmPayment({\r\n      elements,\r\n      confirmParams: {\r\n        // Make sure to change this to your payment completion page\r\n        return_url: \"http://localhost:3000\",\r\n      },\r\n    });\r\n\r\n    // This point will only be reached if there is an immediate error when\r\n    // confirming the payment. Otherwise, your customer will be redirected to\r\n    // your `return_url`. For some payment methods like iDEAL, your customer will\r\n    // be redirected to an intermediate site first to authorize the payment, then\r\n    // redirected to the `return_url`.\r\n    if (error.type === \"card_error\" || error.type === \"validation_error\") {\r\n      setMessage(error.message);\r\n    } else {\r\n      setMessage(\"An unexpected error occurred.\");\r\n    }\r\n\r\n    setIsLoading(false);\r\n  };\r\n\r\n  return (\r\n    <form id=\"payment-form\" onSubmit={handleSubmit}>\r\n      <PaymentElement id=\"payment-element\" />\r\n      <button disabled={isLoading || !stripe || !elements} id=\"submit\">\r\n        <span id=\"button-text\">\r\n          {isLoading ? <div className=\"spinner\" id=\"spinner\"></div> : \"Pay now\"}\r\n        </span>\r\n      </button>\r\n      {/* Show any error or success messages */}\r\n      {message && <div id=\"payment-message\">{message}</div>}\r\n    </form>\r\n  );\r\n}\r\n"],"mappings":"yZAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,OACEC,cADF,CAEEC,SAFF,CAGEC,WAHF,KAIO,yBAJP,C,wFAMA,cAAe,SAASC,aAAT,EAAwB,CACrC,GAAMC,OAAM,CAAGH,SAAS,EAAxB,CACA,GAAMI,SAAQ,CAAGH,WAAW,EAA5B,CAEA,cAA8BH,QAAQ,CAAC,IAAD,CAAtC,wCAAOO,OAAP,eAAgBC,UAAhB,eACA,eAAkCR,QAAQ,CAAC,KAAD,CAA1C,yCAAOS,SAAP,eAAkBC,YAAlB,eAEAX,SAAS,CAAC,UAAM,CACd,GAAI,CAACM,MAAL,CAAa,CACX,OACD,CAED,GAAMM,aAAY,CAAG,GAAIC,gBAAJ,CAAoBC,MAAM,CAACC,QAAP,CAAgBC,MAApC,EAA4CC,GAA5C,CACnB,8BADmB,CAArB,CAIA,GAAI,CAACL,YAAL,CAAmB,CACjB,OACD,CAEDN,MAAM,CAACY,qBAAP,CAA6BN,YAA7B,EAA2CO,IAA3C,CAAgD,cAAuB,IAApBC,cAAoB,MAApBA,aAAoB,CACrE,OAAQA,aAAa,CAACC,MAAtB,EACE,IAAK,WAAL,CACEZ,UAAU,CAAC,oBAAD,CAAV,CACA,MACF,IAAK,YAAL,CACEA,UAAU,CAAC,6BAAD,CAAV,CACA,MACF,IAAK,yBAAL,CACEA,UAAU,CAAC,oDAAD,CAAV,CACA,MACF,QACEA,UAAU,CAAC,uBAAD,CAAV,CACA,MAZJ,CAcD,CAfD,EAgBD,CA7BQ,CA6BN,CAACH,MAAD,CA7BM,CAAT,CA+BA,GAAMgB,aAAY,6FAAG,iBAAOC,CAAP,oJACnBA,CAAC,CAACC,cAAF,GADmB,KAGf,CAAClB,MAAD,EAAW,CAACC,QAHG,kEASnBI,YAAY,CAAC,IAAD,CAAZ,CATmB,sBAWKL,OAAM,CAACmB,cAAP,CAAsB,CAC5ClB,QAAQ,CAARA,QAD4C,CAE5CmB,aAAa,CAAE,CACb;AACAC,UAAU,CAAE,uBAFC,CAF6B,CAAtB,CAXL,4CAWXC,KAXW,uBAWXA,KAXW,CAmBnB;AACA;AACA;AACA;AACA;AACA,GAAIA,KAAK,CAACC,IAAN,GAAe,YAAf,EAA+BD,KAAK,CAACC,IAAN,GAAe,kBAAlD,CAAsE,CACpEpB,UAAU,CAACmB,KAAK,CAACpB,OAAP,CAAV,CACD,CAFD,IAEO,CACLC,UAAU,CAAC,+BAAD,CAAV,CACD,CAEDE,YAAY,CAAC,KAAD,CAAZ,CA9BmB,uDAAH,kBAAZW,aAAY,6CAAlB,CAiCA,mBACE,cAAM,EAAE,CAAC,cAAT,CAAwB,QAAQ,CAAEA,YAAlC,wBACE,KAAC,cAAD,EAAgB,EAAE,CAAC,iBAAnB,EADF,cAEE,eAAQ,QAAQ,CAAEZ,SAAS,EAAI,CAACJ,MAAd,EAAwB,CAACC,QAA3C,CAAqD,EAAE,CAAC,QAAxD,uBACE,aAAM,EAAE,CAAC,aAAT,UACGG,SAAS,cAAG,YAAK,SAAS,CAAC,SAAf,CAAyB,EAAE,CAAC,SAA5B,EAAH,CAAkD,SAD9D,EADF,EAFF,CAQGF,OAAO,eAAI,YAAK,EAAE,CAAC,iBAAR,UAA2BA,OAA3B,EARd,GADF,CAYD"},"metadata":{},"sourceType":"module"}