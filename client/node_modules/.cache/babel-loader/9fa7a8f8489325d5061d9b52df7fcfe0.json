{"ast":null,"code":"import _defineProperty from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/webdev/school/school-online-project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useRef}from\"react\";import{useDispatch}from\"react-redux\";import{newClass,fetchClassesNames,fetchSubjects}from\"../../../store/classes-slice\";import Form,{Title,Text,Dropdown,Checkbox,Schedule,SingleDropdown,Container}from\"../../form/Form\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function CreateClass(props){var initialState={class_name:\"\",teacher_name:\"\",class_description:\"\",schedule:{Monday:false,Tuesday:false,Wednesday:false,Thursday:false,Friday:false,Saturday:false,Sunday:false}};var prerequisitesRef=useRef();var subjectRef=useRef();var formRef=useRef();var _useState=useState([{}]),_useState2=_slicedToArray(_useState,2),classesList=_useState2[0],setClassesList=_useState2[1];var _useState3=useState([{}]),_useState4=_slicedToArray(_useState3,2),subjectsList=_useState4[0],setSubjectsList=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var _useState7=useState(initialState),_useState8=_slicedToArray(_useState7,2),form=_useState8[0],setForm=_useState8[1];var dispatch=useDispatch();function submitHandler(e){e.preventDefault();var prerequisites=prerequisitesRef.current.state.value.map(function(item){var _item$split=item.split(\",\"),_item$split2=_slicedToArray(_item$split,2),class_id=_item$split2[0],prerequisite_class_name=_item$split2[1];return{class_id:class_id,prerequisite_class_name:prerequisite_class_name};});var subject=subjectRef.current.state.value;var data={class_name:form.class_name,teacher_name:form.teacher_name,class_description:form.class_description,class_prerequisites:prerequisites,schedule:form.schedule,subject:subject};dispatch(newClass(data));setForm(initialState);e.target.reset();}useEffect(function(){var getClassesNames=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var response,result,subjectsResponse,subjectsResult;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return dispatch(fetchClassesNames());case 2:response=_context.sent;result=response.map(function(item){return{key:item.class_name,text:item.class_name,value:item._id+\",\"+item.class_name};});setClassesList(result);_context.next=7;return dispatch(fetchSubjects());case 7:subjectsResponse=_context.sent;subjectsResult=subjectsResponse.map(function(item){return{key:item.name,text:item.name,value:item.name};});setSubjectsList(subjectsResult);setIsLoading(false);case 11:case\"end\":return _context.stop();}}},_callee);}));return function getClassesNames(){return _ref.apply(this,arguments);};}();getClassesNames();},[dispatch]);function changeHandler(e){setForm(function(state){return _objectSpread(_objectSpread({},state),{},_defineProperty({},e.target.name,e.target.value));});}function scheduleChangeHandler(e){setForm(function(state){return _objectSpread(_objectSpread({},state),{},{schedule:_objectSpread(_objectSpread({},state.schedule),{},_defineProperty({},e.target.name,e.target.checked))});});}if(isLoading){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}//TODO: simplify this\n// TODO: change into fully controlled component\n// aka eliminate the refs\nreturn/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Form,{onSubmit:submitHandler,btnName:\"Create\",ref:formRef,children:[/*#__PURE__*/_jsx(Title,{children:\"Create Class\"}),/*#__PURE__*/_jsx(Text,{onChange:changeHandler,name:\"class_name\",children:\"Class Name\"}),/*#__PURE__*/_jsx(Text,{onChange:changeHandler,name:\"teacher_name\",children:\"Teacher Name\"}),/*#__PURE__*/_jsx(Text,{onChange:changeHandler,name:\"class_description\",children:\"Class Description\"}),/*#__PURE__*/_jsx(SingleDropdown,{ref:subjectRef,options:subjectsList,children:\"Subject\"}),/*#__PURE__*/_jsx(Dropdown,{ref:prerequisitesRef,options:classesList,children:\"Prerequisites\"}),/*#__PURE__*/_jsxs(Schedule,{children:[/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Monday\",children:\"Mo\"}),/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Tuesday\",children:\"Tu\"}),/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Wednesday\",children:\"We\"}),/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Thursday\",children:\"Th\"}),/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Friday\",children:\"Fr\"}),/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Saturday\",children:\"Sa\"}),/*#__PURE__*/_jsx(Checkbox,{onChange:scheduleChangeHandler,name:\"Sunday\",children:\"Su\"})]})]})});}export default CreateClass;","map":{"version":3,"names":["React","useEffect","useState","useRef","useDispatch","newClass","fetchClassesNames","fetchSubjects","Form","Title","Text","Dropdown","Checkbox","Schedule","SingleDropdown","Container","CreateClass","props","initialState","class_name","teacher_name","class_description","schedule","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","prerequisitesRef","subjectRef","formRef","classesList","setClassesList","subjectsList","setSubjectsList","isLoading","setIsLoading","form","setForm","dispatch","submitHandler","e","preventDefault","prerequisites","current","state","value","map","item","split","class_id","prerequisite_class_name","subject","data","class_prerequisites","target","reset","getClassesNames","response","result","key","text","_id","subjectsResponse","subjectsResult","name","changeHandler","scheduleChangeHandler","checked"],"sources":["C:/webdev/school/school-online-project/client/src/components/teacher/create-class/CreateClass.js"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport {\r\n  newClass,\r\n  fetchClassesNames,\r\n  fetchSubjects,\r\n} from \"../../../store/classes-slice\";\r\nimport Form, {\r\n  Title,\r\n  Text,\r\n  Dropdown,\r\n  Checkbox,\r\n  Schedule,\r\n  SingleDropdown,\r\n  Container,\r\n} from \"../../form/Form\";\r\n\r\nfunction CreateClass(props) {\r\n  const initialState = {\r\n    class_name: \"\",\r\n    teacher_name: \"\",\r\n    class_description: \"\",\r\n    schedule: {\r\n      Monday: false,\r\n      Tuesday: false,\r\n      Wednesday: false,\r\n      Thursday: false,\r\n      Friday: false,\r\n      Saturday: false,\r\n      Sunday: false,\r\n    },\r\n  };\r\n  const prerequisitesRef = useRef();\r\n  const subjectRef = useRef();\r\n  const formRef = useRef();\r\n  const [classesList, setClassesList] = useState([{}]);\r\n  const [subjectsList, setSubjectsList] = useState([{}]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [form, setForm] = useState(initialState);\r\n  const dispatch = useDispatch();\r\n\r\n  function submitHandler(e) {\r\n    e.preventDefault();\r\n    const prerequisites = prerequisitesRef.current.state.value.map((item) => {\r\n      const [class_id, prerequisite_class_name] = item.split(\",\");\r\n      return { class_id, prerequisite_class_name };\r\n    });\r\n    const subject = subjectRef.current.state.value;\r\n    const data = {\r\n      class_name: form.class_name,\r\n      teacher_name: form.teacher_name,\r\n      class_description: form.class_description,\r\n      class_prerequisites: prerequisites,\r\n      schedule: form.schedule,\r\n      subject: subject,\r\n    };\r\n    dispatch(newClass(data));\r\n    setForm(initialState);\r\n    e.target.reset();\r\n  }\r\n\r\n  useEffect(() => {\r\n    const getClassesNames = async () => {\r\n      const response = await dispatch(fetchClassesNames());\r\n      const result = response.map((item) => {\r\n        return {\r\n          key: item.class_name,\r\n          text: item.class_name,\r\n          value: item._id + \",\" + item.class_name,\r\n        };\r\n      });\r\n      setClassesList(result);\r\n      const subjectsResponse = await dispatch(fetchSubjects());\r\n      const subjectsResult = subjectsResponse.map((item) => {\r\n        return {\r\n          key: item.name,\r\n          text: item.name,\r\n          value: item.name,\r\n        };\r\n      });\r\n      setSubjectsList(subjectsResult);\r\n      setIsLoading(false);\r\n    };\r\n    getClassesNames();\r\n  }, [dispatch]);\r\n\r\n  function changeHandler(e) {\r\n    setForm((state) => {\r\n      return { ...state, [e.target.name]: e.target.value };\r\n    });\r\n  }\r\n\r\n  function scheduleChangeHandler(e) {\r\n    setForm((state) => {\r\n      return {\r\n        ...state,\r\n        schedule: { ...state.schedule, [e.target.name]: e.target.checked },\r\n      };\r\n    });\r\n  }\r\n\r\n  if (isLoading) {\r\n    return <div>Loading...</div>;\r\n  }\r\n\r\n  //TODO: simplify this\r\n  // TODO: change into fully controlled component\r\n  // aka eliminate the refs\r\n\r\n  return (\r\n    <Container>\r\n      <Form onSubmit={submitHandler} btnName=\"Create\" ref={formRef}>\r\n        <Title>Create Class</Title>\r\n        <Text onChange={changeHandler} name=\"class_name\">\r\n          Class Name\r\n        </Text>\r\n        <Text onChange={changeHandler} name=\"teacher_name\">\r\n          Teacher Name\r\n        </Text>\r\n        <Text onChange={changeHandler} name=\"class_description\">\r\n          Class Description\r\n        </Text>\r\n        <SingleDropdown ref={subjectRef} options={subjectsList}>\r\n          Subject\r\n        </SingleDropdown>\r\n        <Dropdown ref={prerequisitesRef} options={classesList}>\r\n          Prerequisites\r\n        </Dropdown>\r\n        <Schedule>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Monday\">\r\n            Mo\r\n          </Checkbox>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Tuesday\">\r\n            Tu\r\n          </Checkbox>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Wednesday\">\r\n            We\r\n          </Checkbox>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Thursday\">\r\n            Th\r\n          </Checkbox>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Friday\">\r\n            Fr\r\n          </Checkbox>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Saturday\">\r\n            Sa\r\n          </Checkbox>\r\n          <Checkbox onChange={scheduleChangeHandler} name=\"Sunday\">\r\n            Su\r\n          </Checkbox>\r\n        </Schedule>\r\n      </Form>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default CreateClass;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}